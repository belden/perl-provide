#!/usr/bin/env perl

use strict;
use warnings;

use Test::More tests => 10;

use lib grep { -d } qw(../lib ./lib ./t/lib);
use Test::Easy qw(deep_ok);

{
  use strict;
  use warnings;
  package exporty1;

  use provide (
    if => ge => '1.000000' => 'exporty1::pass',
    else                   => 'exporty1::fail',
  );
}

ok( exporty1->isa('Exporter'), 'exporty1 isa Exporter' );
deep_ok( \@exporty1::pass::EXPORT, [qw(moonset craving)], 'we know what exporty1::pass exports' );
deep_ok( \@exporty1::EXPORT, \@exporty1::pass::EXPORT, 'exporty1 exports the same thing as exporty::pass' );
is( exporty1::pass->moonset, 'exporty1::pass::moonset', 'we know what moonset looks like' );
is( exporty1->moonset, exporty1::pass->moonset, 'moonset is moonset' );

{
  use strict;
  use warnings;
  package exporty2;

  use provide (
    if => lt => $] => 'exporty2::fail',
    else           => 'exporty2::pass',
  );
}

ok( exporty2->isa('Exporter'), 'exporty2 isa Exporter' );
deep_ok( \@exporty2::pass::EXPORT, [qw(cheese)], 'we know what exporty2::pass exports' );
deep_ok( \@exporty2::EXPORT, \@exporty2::pass::EXPORT, 'exporty2 exports the same thing as exporty::pass' );
like( exporty2::pass->cheese, qr/blue cheese.*trash/, "blue cheese smells like trash (but that's not so bad)" );
is( exporty2->cheese, exporty2::pass->cheese, 'cheese is cheese' );

